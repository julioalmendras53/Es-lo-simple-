<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Libro + Razonador</title>

  <style>
    body { font-family: Arial, sans-serif; margin: 1rem; background-color: #fff; }
    
    /* Layout Responsive */
    #contenedor {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1rem;
      width: 100%;
      height: 90vh;
    }

    h1 { grid-column: 1 / -1; margin: 0 0 10px 0; font-size: 1.5rem; text-align: center; }

    /* Libro */
    #libro {
      border: 2px solid #007bff;
      padding: 1rem;
      border-radius: 8px;
      overflow-y: auto;
      background-color: #fafafa;
      line-height: 1.8;
      text-align: justify;
      font-size: 1.1rem;
    }

    .palabra { cursor: pointer; }
    .palabra:hover { background-color: #b3d7ff; color: #000; border-radius: 3px; }
    .palabra.resaltada { background-color: yellow; font-weight: bold; }

    /* Chat */
    #chat-wrapper {
      display: flex;
      flex-direction: column;
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #f9f9f9;
      height: 100%;
      overflow: hidden;
    }

    #chat-header { background: #eee; padding: 10px; font-weight: bold; border-bottom: 1px solid #ddd; }
    
    #chat-history {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .mensaje { padding: 8px 12px; border-radius: 10px; max-width: 90%; font-size: 0.95rem; }
    .msg-bot { align-self: flex-start; background: #fff; border: 1px solid #ddd; }
    .msg-user { align-self: flex-end; background: #007bff; color: white; }
    .msg-system { align-self: center; color: #888; font-style: italic; font-size: 0.8rem; }

    #chat-input-area { display: flex; padding: 10px; border-top: 1px solid #ddd; background: white; }
    #chat-input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 20px; margin-right: 5px; }
    #chat-send { padding: 10px 15px; background: #28a745; color: white; border: none; border-radius: 20px; font-weight: bold; }

    /* Tarjetas */
    .tarjeta { border: 1px solid #ddd; padding: 8px; margin-top: 5px; border-radius: 5px; background: white; border-left: 4px solid #ccc; }
    .ganadora { border-left-color: #28a745; background: #e8f5e9; }

    /* M√ìVIL */
    @media (max-width: 768px) {
      #contenedor { display: flex; flex-direction: column; height: auto; }
      #libro { max-height: 40vh; min-height: 200px; }
      #chat-wrapper { height: 50vh; min-height: 300px; }
    }
  </style>
</head>

<body>

<div id="contenedor">
  <h1>Libro del Infinito</h1>
  
  <div id="libro">
    Cargando libro... (Si esto no cambia en 2 segundos, el script fall√≥)
  </div>

  <div id="chat-wrapper">
    <div id="chat-header">üß† El Razonador</div>
    <div id="chat-history">
      <div class="mensaje msg-bot">Hola. Toca una palabra del texto.</div>
    </div>
    <div id="chat-input-area">
      <input type="text" id="chat-input" placeholder="...">
      <button id="chat-send" onclick="enviarUser()">Enviar</button>
    </div>
  </div>
</div>

<pre id="texto-fuente" style="display:none;">
1 es aterrador 16857 El infinito ha dado un plus a la materia. 16858 El infinito es aterrador como el 1. 16859 No se anda con simplezas √©ste 1. 16860 Si acumularamos los teoremas que tienen por fundamento en el 1, estar√≠amos hasta los 80 a√±os hablando,  sin vejez ya. 16861 El infinito quiere alzarse con el trofeo del 1. 16862 Sin un contexto, el 1, tiene poco que decir. 16863 El infinito pertenece a un conjunto hiperreal. 16864 Si contamos las veces que infinito ha dado algo a este servidor, no bastar√≠a para comenzar. 16865 El infinito tiene a 1 como un posible resultado de m√∫ltiples casos. 16866 Para mostrar un bot√≥n. 16867 La ra√≠z infinita de infinito es tendente al 1. 16868 ¬øQui√©n sac√≥ este naipe del codo? 16869 Parece que las operaciones para llegar a ese resultado no son complejas. 16870 Sin complejidad, cero tiene a√∫n m√°s sentido. 16871 El infinito se desglos√≥ en infinito e infinita para llegar a 1. 16872 El infinito es en un desglose 1 s√≥lo sin m√°s a√±adidos. 
16873 Parece que a√±adir indefinidamente buscase un fin. 16874 Parece que a√±adir 1 al 1 no montara mucho a ojos del infinito. 
16875 Cuando se llega a esos entornos tan brutales, no tiene caso el 1. 16876 El infinito es 1 y el primero. 16877 Ya esboc√© que el 1 es aterrador y partir mi escrito m√°ximo, debe justificar sus decisiones. 16878 Por eso es que en el juego del go, Alfago, demor√≥ de 30 a 40 segundos en responder a la piedra primera acotada por Lee Sedol. 16878 bis La inteligencia dice que para asegurar el fuseki es necesario casi demorar una jugada, que es la m√°s importante.  16879 Que pasara un minuto, tambi√©n podr√≠a ser. 16880 El 1 es tan aterrador, porque no hay destino en la tierra m√°s todav√≠a. 16881 El infinito es vertebrador de los d√≠gitos nombrados. 16882 El infinito es siempre algo que no tiene fin. 16883 Toda la definici√≥n de infinito puede ser puesta en lenguaje matem√°tico. 16884 No hay nada que la matem√°tica y sus matem√°ticos desconozcan del infinito, a√∫n as√≠ insisten en que no tiene sentido, esas operaciones que no gustan. 
16885 Sin el 1, no habr√≠a origen. 16886 Es primero el 1 entre 0, el que pone la pol√©mica en la mesa. 16887 Es m√°s todav√≠a, el 1 es origen de todo n√∫mero, incluyendo el infinito, s√≠ lo creo. 16888 El infinito sigue siendo la v√©rtebra en este universo m√°ximo. 16889 Conseguir el 1 debiera ser el principal objetivo del infinito, pero descreo de ello pronto. 16890 En un plano complejo el 1 es m√°s especial, porque se le a√±aden cosas, sin dejar de ser 1. 16891 El infinito es matem√°ticamente perfecto, ya que de matem√°ticamente puede ser, ya que, por bis, infinito no es existente sin la matem√°tica, y lo de perfecto es claro que el matem√°tico, puede pasar a su dialecto toda la definici√≥n, con alguna reticencia. 16892 El infinito me exige a buscar en 1, algo m√°s all√° del n√∫mero meramente. 16893 Muy obtuso ser√© si llego con que el 1 no es real, en el caso de que cero es denominador. 16894 Algo de verdad tendr√° que cero no puede dividir a ning√∫n/alg√∫n n√∫mero. 16895 O quiz√° est√© hablando el miedo del matem√°tico, con decir que no se puede. 16896 Yo prefiero creer en el miedo, que es m√°s l√≥gico ante algo extra√±o. 16897 El 1 es origen de Google, as√≠ como es origen del n√∫mero de Graham. 16898 Yo no quiero creer eso. 16899 Graham ha desquiciado el 1 con apartarse del sistema num√©rico decimal. 16900 En infinito 1 es el origen debido. 16901 Pero 1 tiene un poder en multiplicarse con n√∫meros alteraandolos m√≠nimamente. 16902 El infinito es una ecuaci√≥n. 16903 Nada en la matem√°tica es cero. 16904 La nada aqu√≠ no est√°. 16905 Si nos vamos a referir a cero, declararemos que es algo por convenci√≥n. 16906 De sumar 1 a 1 result√≥ la ‚àö2. 16907 ¬øC√≥mo es eso? 16907 Muy pocos recursos se hizo Hipaso de Metaponto, al sumar, simple, a 1 con 1. 16908 El infinito tiene un listado de n√∫meros que siguen la ley del infinito. Esto es √±a√±.16909 El infinito tiene a ‚àö2 como su primer elemento. 16910 De ah√≠ saltamos a los n√∫meros primos bajo ra√≠z. 16911 Todo n√∫mero primo bajo ra√≠z, deber√° ser irracional. 
16912 Tratar de aplicar raz√≥n a los n√∫meros primos, quiz√° est√© errado. 16913 El infinito es un n√∫mero, creo. 16914 El infinito es aterrador, misma cosa pasa con el 1. 16915 Parece que a la usanza de infinito, sumar 1 es algo rid√≠culamente especial. 16916 (1 +1) y bajo ra√≠z se sale de raz√≥n. 16917 El 1 no es aterrador, porque es nuestro aliado. 16918 Perder la raz√≥n no es algo especial. 16919 M√°s bien ser raz√≥n es lo especial. 16920 Leer√© este escrito una y otra vez, porque quiero que tenga una coherencia de 666. 16921 Con que la Iglesias referencie a 666 como el n√∫mero bestial bastar√°. 16922 El infinito es un resumen de la existencia. 16923 Partimos con los n√∫meros de contar. 16924 Me miro la mano con 5 dedos y me pregunto, ¬øhabr√° una correspondencia en la naturaleza? 16925 El infinito se hace desde un 1. 16926 Los matem√°ticos nos dicen que el universo se hizo del vac√≠o. 16927 Yo me opongo fuertemente a ello. 16928 Antes de la palabra divina, hab√≠a un ser planeando en el aire del horizonte. 16929 Como abarcando todo. 16930 Quiz√° fue el infinito transmutado en una tierra preexistente. 16931 Un ser era el que planeaba. 16932 Es com√∫n esa idea de que los seres
podr√≠an llegar a volar, por alguna potencia salida de s√≠ mismos. 16933 ¬øQu√© intenci√≥n ten√≠a Dios en planear 1 en la tierra preexistente? 16934 Dios fue singular en ese momento, y sigui√≥ siendo singular todo el tiempo, hasta el futuro m√≠o. 16935 Al menos lleguemos a la frase 17 mil antes de pasar al aterrador 2. 16936 El infinito es un elemento elemental. 16937 Nada avanzar√© con eso. 16938 Sin 1, no tendr√≠amos el altisonante universo. 16939 En el cosmos nada hay de unidad, y ello es extra√±o, ya que 1 est√° en todo n√∫mero. 16940 Para empezar el 1 y el n√∫mero son los divisores de los n√∫meros primos, excluyendo todo otro for√°neo como un n√∫mero compuesto. 16941 El infinito prefiri√≥ negar, antes que decir que su infinito era de 1. 16942 Pudo decir que 1 era su fin, sin embargo, los datos no revelan eso. 16943 Tanto es la definici√≥n del infinito que llega al n√∫mero 3 y 2. 16944 Tres negaciones. 16945 El infinito no tiene 3 fines, sino dos. 16946 Este menosprecio del 1 es caracter√≠stico del car√°cter de no unificar las cosas primero. 16947 El 1 es aterrador, porque no hay algo bajo el sol que guarde m√°s secretos que el triste n√∫mero 1. 16948 Su secretismo es pavoroso. 16949 No hay otro objetivo que hacerte ver que infinito es un n√∫mero real. 16950 Y que lo irreal es el 1. 16951 Sin 1, no tendr√≠amos a 2 ni ‚àö2 . 16952 Sumar 1 entre n√∫meros del 0 al 10, tiene un recorrido asombrosamente grande. 
16953 El 1 tiene algo de grandeza en permitir a los humanos buscar unidad. 16954 El infinito es gestor del 1. 16955 Casi que el primero fuera por infinito. 16956 El infinito es un ser que continuamente est√° amando. 16957 El genio de este escrito es presentar argumentos de la numeridad del infinito y nada m√°s. 16958 El infinito es aterrador como lo es el 1. 16959 Yo sospecho m√°s en 1 que en cero, como la otra cara de la moneda, principiada por infinito. 16960 No hay en cero lo que hay en 1. 
16961 Sin unidad, no tiene sentido hablar del mundo. 16962 Sin unidad, no hay universo, quitando de en medio al cosmos. 16963 Porque el humano todo el tiempo vaga y no va a  los asuntos importantes, es que tenemos universo y no varios. 16964 Sin unidad, no habr√≠a ilusi√≥n en las lenguas, de hacerlas m√°s grandes. 16965 El 1 es la soluci√≥n de innumerables ecuaciones de segundo y tercer grado. 16966 Es mucho el atractivo de poner en 1 nuestra esperanza. 16967 Cuando hallo al 1 en la ecuaci√≥n me siento feliz que sea tan simple y satisfacci√≥n hacerlo. 16968 El infinito es simple, porque la definimos necesariamente con ser. 16969 ¬øCu√°l es el problema con limitar las definiciones a 1 palabra? 16970 El infinito es un kit que viene con las reglas de uso. 16971 El infinito es matem√°ticamente loco. 16972 Yo en un momento fui unidad, cuando me convert√≠ en otra persona, fui transitando hacia el 2. 16973 No entrar√© a tocar el 2 ni ‚àö2 menos. 16974 El infinito halla un nuevo mundo en esta frase. 16975 Si tuvi√©ramos, que creo encima, un n√∫mero asombrosamente largo, con coma decimal y un abismo de ceros, ¬øesperar√≠amos terminar en un cero a favor de toda l√≥gica o hubiere m√°s tarde un 1 final? 16976 ¬øDe d√≥nde sali√≥ ese 1? 16977 ¬øQui√©n me permite imaginar mi cuento? 16978 A partir de aqu√≠, ¬øhabr√° una secuencia infinita de preguntas? 16979 ¬øO se terminar√° todo en una forma ca√≥tica? 16980 Parece que ese 1 testarudo final o finalizador testarudo parte del cero. 16981 Nadie puede tener la haza√±a de hacer de cero algo. 16982 Excepto un ser muy especial como Cristo, √©l de migajas cre√≥ hogazas. 16983 Ya con ese precedente en Cristo, tenemos como justificar que se cree un 1 final. 16984 Nadie apostar√≠a a sacar el cero de su sitio final. 16985 Pero el azar es raro. Lo s√©. 16986 Suceden cosas incre√≠bles todo el tiempo. 16987 Surgi√≥ la vida que era rid√≠culamente improbable. 16988 Hay un ser escribiendo para ti. 16989 Con amor siempre. 16990 El infinito da esas preguntas que nos dejan boquiabiertos por su asombrosa magia. 16991 Despu√©s de un mill√≥n de ceros, ¬øqui√©n no se cansar√≠a de la monoton√≠a? 16992 Ra√≠z de 1 es 1. 16993 Ra√≠z c√∫bica de 1 es 1. 16994 Y ya la racha es imparable. 16995 Ra√≠z infinita de 1 es 1. 16996 ¬øQu√© significa esto? 16997 Si ra√≠z infinita de 1 es 1 e infinita de infinito es tendiente de 1, es claro que alguien miente. 16997 bis La clave est√° en que uno tiende al 1  y el otro es 1.   16998 Ese movimiento de 1 es imposible. 16999 No puede ser 1, porque infinito lo impide. 17000 El infinito est√° lleno de preguntas sin contestaci√≥n. 
17001 El infinito puede continuar sin l√≠mites, andando en esta met√°fora. 17002 El 1 sumado al mismo, produce 2 elementos. 17003 Ning√∫n n√∫mero es tan querend√≥n del 1 como 2. 17004 Si no acabamos con el 1, menos podremos acabar con los siguientes n√∫meros. 17005 El 1 es algo interesante, ya que representa la cosa. 17006 ¬øEs el infinito cruel con el 1, al no tomarlo en cuenta? 17007 Podemos caer en un abismo con el 1 tan solo partiendo. 17008 No hay n√∫mero m√°s poderoso que 1. 17009 Me obligo a extender grandemente el an√°lisis de 1. 17010 El 1 es una cosa simple. 17011 Sin el 1, no habr√≠a origen. 17012 El 6 tiene como origen el 3 y el 2. 17013 Porque 3√ó2 es 6. 17014 Nada impide que 3√ó2√ó1 sea la definitiva. 17015 A la vista salta que el n√∫mero, no tiene como origen un n√∫mero m√°s alto, sino todo lo contrario. 17016 El infinito juega con 1 y termina mal usado. 17017 Es el 1 el juguete de infinito, todas las veces. 17018 ¬øA qu√© se debe esa inquina del infinito por 1 y 0? 17019 La posici√≥n en infinito deja de tener sentido, as√≠ el cero que significa n√∫mero, no tiene cabida en el n√∫mero final. 
17020 El infinito es num√©rico por cero razones. 17021 De 10 saco 0.  17022 Todo es muy extra√±o por tener fin. 17023 Se supone que el todopoderoso lo pod√≠a todo. 17024 Pero esto es un enga√±o.  17025 El infinito como un ni√±o ordenando n√∫meros en su cunita, es la m√°xima expresi√≥n. 17026 El infinito es un n√∫mero, porque tambi√©n es un l√≠mite. 17027 El l√≠mite puede decidirse a ser n√∫mero, solamente si maquinamos las cosas. 17028 El infinito da continuidad a algo. 17029 Sin ver lo previamente dicho, estoy exhalando palabras. 17030 Sin ver la historia, es que hago historia. 17031 Al infinito no pueden confiar los l√≠mites. 17032 Ojo a todo por infinito. 17033 Nada o cero puede multiplicar a alguien, sin cancelarse  en el proceso. 17034 Hay m√°s y es que cero produce con alguien un todo. 17035 Cero merece tanto espacio como el 1. 17036 Todo por infinito no puede ser. 17037 Dar√≠a algo extra√±amente distinto a cero. 17038 No puedo mover en la ecuaci√≥n a cero, como si no hubiera ma√±ana. 17039 El movimiento del caballo en ajedrez es parecido a lo que quiero explicar. 17039 Incluso para lo absoluto como el 1 mezclado traicioneramente con infinito, algo no puede ser. 17040 El infinito es un final no esperado. 17041 Quisi√©ramos que tras infinito, hubiera m√°s materia o esp√≠ritu andando. 17042 Del infinito demostrar√© que es verdaderamente n√∫mero. 17043 Pero para ello necesito empezar con el 1. 17044 Sin monote√≠smo, ser√≠amos seres muy desgraciados. 17045 Del 1 podemos observar infinidad de cosas. 17046 Entre 1 y 0 est√° todo el asunto. 17047 Quiz√° no pase del cero en este presente volumen. 17048 Hay tanto por hablar de estos dos especiales n√∫meros que temo, por tanto. 17049 El infinito se ordena en la ecuaci√≥n a una forma de enlazarse. 17050 No puede haber infinito√ó1.  17051 De fracci√≥n viene el impedimento. 17052 Bien. 17053 El infinito tiene por gusto basar sus reglas en el 1. 17054 ¬øQui√©n desglosaraa m√°s que infinito? 17055 Sin el 1, la nada, tendr√≠a m√°s diab√≥lico sentido. 17056 Es en el 1 en que apoyamos nuestra fe. 17057 De un monote√≠smo feo, heredamos a Dios. 17058 Llega el momento de preguntar. 17059 Muchas cosas han robado mi imaginaci√≥n en estos d√≠as. 17060 √âsta es una. 17061 En la hip√≥tesis de Riemann tenemos una funci√≥n z que tiene un polo simple en s=1. 17062 Sabemos con mucha ciencia que ese polo simple diverge. 17063 Eso significa que se dispara con lentitud hacia el infinito. 17064 Es como si dispararas una sand√≠a con una honda o un planeta con una cuchara, algo totalmente lento 17065 Con cari√±o te traer√© a qu√© n√∫mero se eleva la cuenta con 10 millones y 100 millones, maguer eso signifique sufrimiento para la m√°quina. 17066 Mejor lo hice con un g√∫gol de sumatorias. 17067 Para 10 millones dio 16,7.  17068 Para un g√∫gol dio 230,84. 17068 Esta lenta sumatoria es debido a que con el polo simple de s=1 se suma 1 + ¬Ω +‚Öì +¬º +‚Öï +‚Öô + 1/7 + ‚Öõ‚Ä¶ etc. 17069 Como ves el polo simple se dispara al infinito, con 1 g√∫gol dio 230 simple. 17070 Temo meterme en la tratativas de esta hip√≥tesis. 17071 Ya que es muy complejo. 17072 Existe un rumor que dice que la hip√≥tesis de Riemann es clarificadora de los n√∫meros primos. 17073 No hago sin raz√≥n esto. 17074 Primero botemos una frase de infinito. 17075 El infinito de Riemann en el polo simple es muy lento. 17076 Nadie sabe por qu√© se llama polo simple. 17077 ¬øAcaso es un punto? 17078 Este s=1 es un infinito igualando a otro. 17079 Por un lado tendr√≠amos un n√∫mero que se ingresa y otro que sale, y si necesitamos del n√∫mero infinito para llegar a infinito, no s√© de qu√© hablamos. 17080 No hago esto sin raz√≥n. 17081 Los n√∫meros primos son los naturales mayores a 1, que, pueden dividirse por 1 y por √©l mismo o s√≠ mismo. 17082 Para que sea 1 la factorizaci√≥n, se rechazan los enteros negativos juntando cero. 17083 La m√°quina me explic√≥ esto y qued√© satisfecho. 17084 Te traigo en breve esto. 
30=(-2)√ó3 √ó(-5)
30=2√ó3√ó5 7085 Con n√∫meros negativos hace que la factorizaci√≥n no sea √∫nica. 17086 As√≠ que por conveniencia, se fij√≥ a los primos como s√≥lo los naturales. 17087 ¬øQu√© hay del infinito? 17088 No hay una factorizaci√≥n del infinito, por lo que, el infinito se queda solo en un puede ser primo. 17089 El 1 no para de asombrarnos, porque hay m√°s. 17090 El primo 2 y 3 tienen de diferencia 1. 17091 Y para su sorpresa, son los dos √∫nicos primos que tienen una diferencia de 1 en toda la recta de primos. 17092 M√°s all√° la diferencia de 1 se pierde totalmente. 17093 El 1 no es primo c√≥mo sospechamos que infinito sea impar y primo, por razones no del todo honestas. 17094 Si el infinito es impar, habr√≠a una conexi√≥n de Noes que ser√≠a interesante ver. 17095 Con un impar coronando, ser√≠a la muerte del par. 17096 El infinito es un n√∫mero por la transfusi√≥n de verdades, desde la propia matem√°tica hacia la gente. 17097 Sin el 1, la matem√°tica estar√≠a inexistente a√∫n en el siglo XXI. 17098 Son innumerables las ocasiones en que 1, ha venido a definir las cosas. 17099 Basta con echar ojo a los n√∫meros primos y veremos que si se dividen por 1, siguen siendo ellos. 17100 El infinito es un l√≠mite al que se encamina este socio.
</pre>

<script>
// 1. FORZAR ESPERA A QUE CARGUE LA P√ÅGINA
window.onload = function() {
    try {
        console.log("Iniciando aplicaci√≥n...");
        prepararLibro();
    } catch(e) {
        alert("Error cr√≠tico iniciando: " + e.message);
    }
};

// --- LOGICA ---

// Normalizaci√≥n
function norm(str) { 
  if(!str) return "";
  return str.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[^a-z0-9√±]/gi, ""); 
}

// Diccionario (Simplificado para evitar errores de sintaxis)
const diccionario = {
  infinito: { definicion: "Que no tiene fin o t√©rmino." },
  aterrador: { definicion: "Que causa terror o mucho miedo." },
  plus: { definicion: "Algo extra o a√±adido." },
  materia: { definicion: "Sustancia que forma los cuerpos f√≠sicos." },
  simplezas: { definicion: "Cosas simples, tonter√≠as o de poca importancia." },
  teorema: { definicion: "Proposici√≥n demostrable mediante reglas l√≥gicas." },
  fundamento: { definicion: "Base o cimiento sobre el que se apoya algo." },
  vejez: { definicion: "√öltima etapa de la vida." },
  trofeo: { definicion: "Objeto que se da en se√±al de victoria." },
  hiperreal: { definicion: "M√°s all√° de lo real, en matem√°ticas n√∫meros que incluyen infinitos." },
  servidor: { definicion: "Persona que sirve, o computadora que da datos." },
  raiz: { definicion: "Origen o base. En matem√°ticas, n√∫mero que multiplicado da otro." },
  naipe: { definicion: "Carta de la baraja." },
  compleja: { definicion: "Dif√≠cil, compuesta de varios elementos." },
  desglose: { definicion: "Separaci√≥n de las partes de un todo." },
  brutal: { definicion: "Muy grande, intenso o violento." },
  decision: { definicion: "Determinaci√≥n definitiva adoptada en un asunto." },
  inteligencia: { definicion: "Facultad de la mente de aprender y razonar." },
  destino: { definicion: "Fuerza desconocida que se cree act√∫a sobre las personas." },
  vertebra: { definicion: "Cada hueso de la columna, o pieza central de algo." },
  matematica: { definicion: "Ciencia de los n√∫meros y figuras." },
  origen: { definicion: "Principio, nacimiento o causa de algo." },
  polemica: { definicion: "Discusi√≥n o controversia." },
  objetivo: { definicion: "Fin o meta a la que se quiere llegar." },
  perfecto: { definicion: "Que tiene todas las cualidades deseables, sin errores." },
  dialecto: { definicion: "Variedad de un idioma." },
  reticencia: { definicion: "Desconfianza o reserva." },
  obtuso: { definicion: "Tonto o que comprende lentamente. √Ångulo mayor a 90 grados." },
  miedo: { definicion: "Sensaci√≥n de angustia ante un peligro." },
  logico: { definicion: "Que sigue las reglas de la raz√≥n." },
  google: { definicion: "Buscador de internet gigante." },
  graham: { definicion: "N√∫mero de Graham, un n√∫mero inmensamente grande." },
  decimal: { definicion: "Sistema num√©rico basado en 10." },
  ecuacion: { definicion: "Igualdad matem√°tica con inc√≥gnitas." },
  convencion: { definicion: "Acuerdo o norma aceptada por todos." },
  recurso: { definicion: "Medio para conseguir algo." },
  primo: { definicion: "N√∫mero divisible solo por 1 y por s√≠ mismo." },
  irracional: { definicion: "Que no tiene raz√≥n. En mates, n√∫mero que no es fracci√≥n exacta." },
  usanza: { definicion: "Modo o costumbre." },
  aliado: { definicion: "Que est√° unido con otro para un fin." },
  coherencia: { definicion: "Relaci√≥n l√≥gica entre las cosas." },
  bestial: { definicion: "Brutal, propio de bestias." },
  existencia: { definicion: "Acto de existir o vivir." },
  vacio: { definicion: "Falta de contenido f√≠sico o mental." },
  divina: { definicion: "Relacionado con Dios." },
  horizonte: { definicion: "L√≠nea donde se unen tierra y cielo." },
  potencia: { definicion: "Capacidad de hacer algo." },
  singular: { definicion: "√önico, solo o extraordinario." },
  cosmos: { definicion: "El universo como un todo ordenado." },
  caracter: { definicion: "Conjunto de rasgos de una persona o cosa." },
  secreto: { definicion: "Algo oculto que no se debe contar." },
  humano: { definicion: "Perteneciente a la especie Homo Sapiens." },
  gestor: { definicion: "Persona que administra algo." },
  amor: { definicion: "Sentimiento intenso de afecto." },
  esperanza: { definicion: "Confianza en lograr lo que se desea." },
  kit: { definicion: "Conjunto de herramientas o piezas." },
  caotico: { definicion: "Desordenado, confuso." },
  azar: { definicion: "Causa imprevista, suerte." },
  monotonia: { definicion: "Falta de variedad, aburrimiento." },
  metafora: { definicion: "Figura ret√≥rica de comparaci√≥n." },
  abismo: { definicion: "Profundidad grande y peligrosa." },
  inquina: { definicion: "Aversi√≥n o mala voluntad." },
  limite: { definicion: "L√≠nea real o imaginaria que separa dos cosas." },
  continuidad: { definicion: "Uni√≥n natural entre partes, sin interrupci√≥n." },
  traicion: { definicion: "Falta de lealtad." },
  monoteismo: { definicion: "Creencia en un solo Dios." },
  hipotesis: { definicion: "Suposici√≥n para iniciar una investigaci√≥n." },
  diverge: { definicion: "Separarse o irse alejando." },
  lento: { definicion: "Poco veloz." },
  sufrimiento: { definicion: "Dolor f√≠sico o moral." },
  gugol: { definicion: "N√∫mero 1 seguido de 100 ceros." },
  rumor: { definicion: "Noticia no confirmada que corre entre la gente." },
  factorizacion: { definicion: "Descomposici√≥n de un n√∫mero en factores." },
  impar: { definicion: "N√∫mero no divisible por dos." },
  transfusion: { definicion: "Paso de un l√≠quido (como sangre) de un lado a otro." },
  socio: { definicion: "Persona asociada con otra." },
  
  // Palabras comunes
  el: { definicion: "Art√≠culo determinado." },
  la: { definicion: "Art√≠culo determinado femenino." },
  uno: { definicion: "El primer n√∫mero natural." },
  cero: { definicion: "Ausencia de cantidad." }
};

let tokens = [];

function prepararLibro() {
  const divLibro = document.getElementById("libro");
  const elTexto = document.getElementById("texto-fuente");
  
  // CLAVE: Usar textContent para leer aunque est√© oculto
  const textoRaw = elTexto.textContent || elTexto.innerText; 
  
  if(!textoRaw || textoRaw.trim().length === 0) {
     divLibro.innerHTML = "Error: No pude leer el texto fuente.";
     return;
  }

  divLibro.innerHTML = ""; // Limpiar el "Cargando..."
  
  tokens = textoRaw.split(/(\s+)/);
  
  let html = "";
  tokens.forEach((t, i) => {
    if(t.trim().length === 0) {
      divLibro.appendChild(document.createTextNode(t));
    } else {
      let span = document.createElement("span");
      span.textContent = t;
      span.className = "palabra";
      span.onclick = function() { analizar(t, i); };
      divLibro.appendChild(span);
    }
  });
}

function analizar(palabra, index) {
  // Limpiar resaltado anterior
  document.querySelectorAll(".resaltada").forEach(e => e.classList.remove("resaltada"));
  
  // Resaltar actual (buscando por texto exacto simple)
  // Nota: En una app real usar√≠amos IDs √∫nicos, aqu√≠ simplificamos visualmente
  event.target.classList.add("resaltada");

  const limpia = norm(palabra);
  const entrada = diccionario[limpia];
  const chat = document.getElementById("chat-history");
  
  let msg = "";
  
  if(entrada) {
     msg = `<strong>${palabra}</strong>: ${entrada.definicion}`;
     // A√±adir contexto visual
     const contexto = obtenerContexto(index);
     addMsg(`He analizado "<strong>${palabra}</strong>" en la frase: <em>"...${contexto}..."</em>`, "system");
     setTimeout(() => addMsg(msg, "bot"), 400);
  } else {
     addMsg(`Mmm... la palabra "<strong>${palabra}</strong>" no est√° en mi √≠ndice todav√≠a.`, "bot");
  }
}

function obtenerContexto(idx) {
  let start = Math.max(0, idx - 10);
  let end = Math.min(tokens.length, idx + 10);
  return tokens.slice(start, end).join("");
}

function addMsg(html, tipo) {
  const div = document.createElement("div");
  div.className = `mensaje msg-${tipo}`;
  div.innerHTML = html;
  const hist = document.getElementById("chat-history");
  hist.appendChild(div);
  hist.scrollTop = hist.scrollHeight;
}

function enviarUser() {
  const inp = document.getElementById("chat-input");
  const txt = inp.value;
  if(!txt) return;
  addMsg(txt, "user");
  inp.value = "";
  setTimeout(() => addMsg("Interesante observaci√≥n.", "bot"), 600);
}
</script>

</body>
</html>
